<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Portal</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="data.js"></script>
    <style>:root{--primary-blue:#3d8bff;--light-blue:#e7f1ff;--background-color:#f7f8fc;--card-background:#ffffff;--text-primary:#212529;--text-secondary:#6c757d;--border-color:#e9ecef;--light-grey-bg:#f8f9fa;--shadow:0 4px 15px rgba(0,0,0,0.06);--font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif}body{font-family:var(--font-family);background-color:var(--background-color);color:var(--text-primary);margin:0;padding-top:60px}.container{max-width:800px;margin:0 auto;padding:1rem}.app-header{position:fixed;top:0;left:0;right:0;display:flex;align-items:center;background-color:var(--card-background);padding:0 1rem;height:60px;border-bottom:1px solid var(--border-color);z-index:1000}.back-arrow{font-size:1.8rem;text-decoration:none;color:var(--text-primary);margin-right:1rem}.app-header h1{font-size:1.2rem;margin:0}.card{background:var(--card-background);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem;box-shadow:var(--shadow)}.btn{display:inline-block;width:100%;box-sizing:border-box;padding:.9rem 1.5rem;border:none;border-radius:50px;font-size:1rem;font-weight:700;cursor:pointer;text-align:center;text-decoration:none;transition:transform .1s ease-out}.btn:active{transform:scale(.98)}.btn-primary{background-color:var(--primary-blue);color:#fff}.form-group{margin-bottom:1rem}.form-group label{display:block;margin-bottom:.5rem;font-weight:500;color:var(--text-secondary)}select,input,textarea{width:100%;padding:.8rem 1rem;border-radius:10px;border:1px solid var(--border-color);background-color:var(--light-grey-bg);font-size:1rem;box-sizing:border-box;color:var(--text-primary)}select:focus,input:focus,textarea:focus{outline:none;border-color:var(--primary-blue);box-shadow:0 0 0 2px var(--light-blue)}</style>
</head>
<body>
    <header class="app-header">
        <a href="index.html" class="back-arrow">‚Üê</a>
        <h1>Teacher Portal</h1>
    </header>
    <div class="container">
        <form id="question-form" class="card">
            <h2 style="margin-top: 0; text-align:center;">Add New Question</h2>
            <div class="form-group"><label>Class:</label><select id="class-select" required><option value="">Select Class</option></select></div>
            <div class="form-group"><label>Subject:</label><select id="subject-select" required><option value="">Select Subject</option></select></div>
            <div class="form-group"><label>Chapter:</label><select id="chapter-select" required><option value="">Select Chapter</option></select></div>
            <hr style="margin: 2rem 0; border: 1px solid #eee;">
            <div class="form-group"><label>Question Text:</label><textarea id="question-text" rows="3" required></textarea></div>
            <div class="form-group"><label>Option A:</label><input type="text" id="option-a" required></div>
            <div class="form-group"><label>Option B:</label><input type="text" id="option-b" required></div>
            <div class="form-group"><label>Option C:</label><input type="text" id="option-c" required></div>
            <div class="form-group"><label>Option D:</label><input type="text" id="option-d" required></div>
            <div class="form-group"><label>Correct Answer:</label><select id="correct-answer" required><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option></select></div>
            <div class="form-group"><label>Difficulty:</label><select id="difficulty-select" required><option value="Easy">Easy</option><option value="Medium">Medium</option><option value="Hard">Hard</option></select></div>
            <div class="form-group"><label>Detailed Solution:</label><textarea id="solution-text" rows="4" required></textarea></div>
            <button type="submit" class="btn btn-primary" id="save-btn">Save Question</button>
        </form>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const firebaseConfig = { apiKey: "AIzaSyBBB2_DHwjdxZpMJYnTSC0BeQKCKP0xlWs", authDomain: "xperts-auth.firebaseapp.com", projectId: "xperts-auth", storageBucket: "xperts-auth.appspot.com", messagingSenderId: "143568403446", appId: "1:143568403446:web:669a8964aa88aab9b065d7" };
            if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
            const db = firebase.firestore();
            const classSelect = document.getElementById('class-select'), subjectSelect = document.getElementById('subject-select'), chapterSelect = document.getElementById('chapter-select');
            for (const className in academicData) { classSelect.innerHTML += `<option value="${className}">${className}</option>`; }
            classSelect.addEventListener('change', () => {
                const selectedClass = classSelect.value; subjectSelect.innerHTML = '<option value="">Select Subject</option>'; chapterSelect.innerHTML = '<option value="">Select Chapter</option>';
                if (selectedClass) { for (const subjectName in academicData[selectedClass]) { subjectSelect.innerHTML += `<option value="${subjectName}">${subjectName}</option>`; } }
            });
            subjectSelect.addEventListener('change', () => {
                const selectedClass = classSelect.value, selectedSubject = subjectSelect.value; chapterSelect.innerHTML = '<option value="">Select Chapter</option>';
                if (selectedSubject) { academicData[selectedClass][selectedSubject].forEach(chapter => { chapterSelect.innerHTML += `<option value="${chapter}">${chapter}</option>`; }); }
            });
            document.getElementById('question-form').addEventListener('submit', (e) => {
                e.preventDefault(); document.getElementById('save-btn').disabled = true;
                const questionData = { class: classSelect.value, subject: subjectSelect.value, chapter: chapterSelect.value, difficulty: document.getElementById('difficulty-select').value, questionText: document.getElementById('question-text').value, options: { A: document.getElementById('option-a').value, B: document.getElementById('option-b').value, C: document.getElementById('option-c').value, D: document.getElementById('option-d').value, }, correctAnswer: document.getElementById('correct-answer').value, solution: document.getElementById('solution-text').value, createdAt: firebase.firestore.FieldValue.serverTimestamp() };
                db.collection("questions").add(questionData)
                    .then(() => { alert('Question saved successfully!'); e.target.reset(); classSelect.dispatchEvent(new Event('change')); })
                    .catch((error) => { console.error("Error adding document: ", error); alert('Error saving question. Check console.'); })
                    .finally(() => { document.getElementById('save-btn').disabled = false; });
            });
        });
    </script>
</body>
</html>
