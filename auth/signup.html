<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join ALLEN</title>
    <style>
        :root { /* styles from previous response */ }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; background-color: #f0f2f5; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { background-color: #fff; width: 100%; max-width: 420px; min-height: 600px; padding: 2rem 1.5rem; display: flex; flex-direction: column; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .progress-bar { width: 100%; height: 4px; background-color: #e0e0e0; border-radius: 2px; margin-bottom: 2rem; }
        .progress-bar-inner { width: 0%; height: 100%; background-color: #007bff; border-radius: 2px; transition: width 0.4s ease; }
        .step { display: none; flex-direction: column; align-items: center; text-align: center; flex-grow: 1; }
        .step.active { display: flex; }
        .step-image { margin-bottom: 2rem; display: flex; justify-content: center; align-items: center; }
        .step-image svg { width: 120px; height: 120px; color: #007bff; }
        h2 { font-size: 1.5rem; font-weight: 700; color: #333; margin-bottom: 0.5rem; }
        p, label { font-size: 1rem; color: #666; margin-bottom: 1.5rem; }
        .input-field, .btn-primary, .btn, .choice-btn { width: 100%; padding: 14px; font-size: 1rem; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 1rem; }
        .btn, .choice-btn { background-color: #f0f2f5; color: #4b4f56; cursor: pointer; transition: all 0.2s; font-weight: 500; }
        .btn:hover, .choice-btn:hover { background-color: #e2e6ea; border-color: #bbb; }
        .btn-primary { background-color: #007bff; color: white; border: none; font-weight: 600; }
        .choice-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; width: 100%; }
        .choice-grid.single-col { grid-template-columns: 1fr; }
        .choice-grid .choice-btn { margin-bottom: 0; }
        .form-group { width: 100%; margin-bottom: 1rem; text-align: left;}
        .form-group label { margin-bottom: 0.5rem; display: block; }
        #error-message { color: #d93025; margin-top: 15px; font-size: 0.9rem; height: 20px;}
    </style>
</head>
<body>

    <div class="container">
        <div class="progress-bar"><div id="progress-bar-inner" class="progress-bar-inner"></div></div>

        <!-- Step 1: Name -->
        <div id="step-1" class="step active">
            <div class="step-image">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bulb" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7" /><path d="M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3" /><path d="M9.7 17l4.6 0" /></svg>
            </div>
            <h2>We are excited to have you join the ALLEN family!</h2>
            <p>What should we call you?</p>
            <input type="text" id="fullName" class="input-field" placeholder="Student's full name">
            <button class="btn" onclick="nextStep(2)">Next</button>
        </div>

        <!-- Step 2: Goal -->
        <div id="step-2" class="step">
            <div class="step-image">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-target-arrow" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M12 12m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0" /><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M15 12h5" /><path d="M18 9l3 3l-3 3" /></svg>
            </div>
            <h2 id="greeting">Hi, [Name]!</h2>
            <p>Please tell us your goal?</p>
            <div class="choice-grid single-col">
                <button class="choice-btn" onclick="selectGoal('NEET')">NEET</button>
                <button class="choice-btn" onclick="selectGoal('JEE')">JEE</button>
                <button class="choice-btn" onclick="selectGoal('Class 6-10')">Class 6-10</button>
            </div>
        </div>

        <!-- Step 3-4 will re-use Goal SVG -->
        <div id="step-3" class="step"><!-- ... Class selection ... --></div>
        <div id="step-4" class="step"><!-- ... Board selection ... --></div>
        
        <!-- Step 5: Additional Info -->
        <div id="step-5" class="step">
            <div class="step-image">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user-edit" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" /><path d="M6 21v-2a4 4 0 0 1 4 -4h3.5" /><path d="M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z" /></svg>
            </div>
            <h2>Just a few more details...</h2>
             <!-- Form fields from previous response -->
            <div class="form-group"><label for="email">Your Email ID</label><input type="email" id="email" class="input-field" placeholder="student@example.com"></div>
            <div class="form-group"><label for="mobile">Your Mobile Number</label><input type="tel" id="mobile" class="input-field" placeholder="10-digit mobile number"></div>
            <div class="form-group"><label for="gender">Gender</label><select id="gender" class="input-field"><option value="">Select Gender</option><option value="Male">Male</option><option value="Female">Female</option><option value="Other">Prefer not to say</option></select></div>
            <div class="form-group"><label for="parentName">Parent's Name</label><input type="text" id="parentName" class="input-field" placeholder="Parent's full name"></div>
            <div class="form-group"><label for="parentMobile">Parent's Mobile Number</label><input type="tel" id="parentMobile" class="input-field" placeholder="Parent's mobile number"></div>
            <button class="btn" onclick="nextStep(6)">Continue</button>
        </div>

        <!-- Step 6: Password -->
        <div id="step-6" class="step">
            <div class="step-image">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-lock" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z" /><path d="M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0" /><path d="M8 11v-4a4 4 0 1 1 8 0v4" /></svg>
            </div>
            <h2>Almost done!</h2>
            <p>Create a secure password.</p>
            <input type="password" id="password" class="input-field" placeholder="Create Password (min. 6 characters)">
            <button class="btn" onclick="submitForm()">Create Account</button>
        </div>

        <!-- Step 7: Final -->
        <div id="step-7" class="step">
            <div class="step-image">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-backpack" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 18v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" /><path d="M9 6v-1a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v1" /><path d="M6 10h12" /><path d="M9 14h6" /></svg>
            </div>
            <h2>Thank you for sharing your details!</h2>
            <p>Let's setup your ALLEN experience.</p>
            <button class="btn-primary" onclick="goToLogin()">Lets Go!</button>
        </div>
        
        <p id="error-message"></p>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    <script>
        // ❗️❗️❗️ PASTE YOUR REAL FIREBASE CONFIG HERE ❗️❗️❗️
        const firebaseConfig = {
          apiKey: "AIzaSy_YOUR_REAL_API_KEY",
          authDomain: "your-project-id.firebaseapp.com",
          /* ... and so on */
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // The JavaScript logic from the previous response is unchanged.
        // It correctly handles the multi-step form.
        let currentStep = 1;
        const totalSteps = 7;
        const formData = {};
        const errorMessage = document.getElementById('error-message');
        function updateProgressBar() { const progress = ((currentStep - 1) / (totalSteps - 1)) * 100; document.getElementById('progress-bar-inner').style.width = `${progress}%`; }
        function nextStep(step) { errorMessage.textContent = ''; if (currentStep === 1) { const name = document.getElementById('fullName').value.trim(); if (!name) { errorMessage.textContent = "Please enter your name."; return; } formData.fullName = name; document.getElementById('greeting').textContent = `Hi, ${name}!`; } if (currentStep === 5) { formData.email = document.getElementById('email').value.trim(); formData.mobile = document.getElementById('mobile').value.trim(); formData.gender = document.getElementById('gender').value; formData.parentName = document.getElementById('parentName').value.trim(); formData.parentMobile = document.getElementById('parentMobile').value.trim(); if (!formData.email || !formData.mobile || !formData.gender || !formData.parentName) { errorMessage.textContent = "Please fill all required fields."; return; } } document.querySelectorAll('.step.active').forEach(s => s.classList.remove('active')); currentStep = step; document.getElementById(`step-${currentStep}`).classList.add('active'); updateProgressBar(); }
        function selectGoal(goal) { formData.goal = goal; if (goal === 'Class 6-10') { // Dynamically create and show step 3 & 4 if they don't exist createClassAndBoardSteps(); nextStep(3); } else { nextStep(5); } }
        function createClassAndBoardSteps() { if(document.getElementById('step-3-content')) return; const step3 = document.getElementById('step-3'); const step4 = document.getElementById('step-4'); step3.innerHTML = `<div id="step-3-content" class="step-content"><div class="step-image">${document.querySelector('#step-2 .step-image').innerHTML}</div><h2>You selected, Class 6-10!</h2><p>Which class are you in?</p><div class="choice-grid"><button class="choice-btn" onclick="selectClass('6th')">6th</button><button class="choice-btn" onclick="selectClass('7th')">7th</button><button class="choice-btn" onclick="selectClass('8th')">8th</button><button class="choice-btn" onclick="selectClass('9th')">9th</button><button class="choice-btn" onclick="selectClass('10th')">10th</button></div></div>`; step4.innerHTML = `<div id="step-4-content" class="step-content"><div class="step-image">${document.querySelector('#step-2 .step-image').innerHTML}</div><h2>Great!</h2><p>Which board are you studying under?</p><div class="choice-grid"><button class="choice-btn" onclick="selectBoard('CBSE')">CBSE</button><button class="choice-btn" onclick="selectBoard('ICSE')">ICSE</button><button class="choice-btn" onclick="selectBoard('State Board')">State Board</button><button class="choice-btn" onclick="selectBoard('Others')">Others</button></div></div>`;}
        function selectClass(className) { formData.class = className; nextStep(4); }
        function selectBoard(board) { formData.board = board; nextStep(5); }
        async function submitForm() { errorMessage.textContent = ''; formData.password = document.getElementById('password').value; if (formData.password.length < 6) { errorMessage.textContent = 'Password must be at least 6 characters.'; return; } const btn = event.target; btn.disabled = true; btn.textContent = 'Creating...'; try { const emailCheck = await db.collection('users').where('email', '==', formData.email).get(); if (!emailCheck.empty) throw new Error('This email address is already registered.'); const mobileCheck = await db.collection('users').where('mobile', '==', formData.mobile).get(); if (!mobileCheck.empty) throw new Error('This mobile number is already registered.'); const userCredential = await auth.createUserWithEmailAndPassword(formData.email, formData.password); const user = userCredential.user; await db.collection('users').doc(user.uid).set({ fullName: formData.fullName, email: formData.email, mobile: formData.mobile, goal: formData.goal, class: formData.class || null, board: formData.board || null, gender: formData.gender, parentName: formData.parentName, parentMobile: formData.parentMobile, role: 'student', approved: false, createdAt: firebase.firestore.FieldValue.serverTimestamp() }); nextStep(7); } catch (error) { console.error("Signup Error:", error); errorMessage.textContent = error.message || 'Failed to create account.'; btn.disabled = false; btn.textContent = 'Create Account'; } }
        function goToLogin() { window.location.href = 'index.html'; }
        updateProgressBar();
    </script>
</body>
</html>
